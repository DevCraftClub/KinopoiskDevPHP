<?php

namespace KinopoiskDev\Utils;

abstract class DataManager {
	/**
	 * Преобразует массив объектов в массив массивов
	 *
	 * Вспомогательный защищенный метод для преобразования коллекции объектов
	 * в массив массивов путем вызова метода toArray() для каждого объекта.
	 * Используется для сериализации связанных объектов (например, жанров, стран)
	 * при преобразовании основного объекта фильма в массив данных.
	 *
	 * @internal Внутренний метод, не является частью публичного API
	 *
	 * @param   mixed  $objects  Коллекция объектов для преобразования или любое другое значение.
	 *                           Может быть массивом объектов с методом toArray(), null или false
	 *
	 * @return  array  Массив массивов, полученный путем вызова toArray() для каждого объекта.
	 *                 Возвращает пустой массив, если входные данные пустые (null, false, пустой массив)
	 *
	 * @see     Movie::toArray() Основной метод преобразования объекта фильма в массив
	 * @see     Genre::toArray() Метод преобразования жанра в массив
	 * @see     Country::toArray() Метод преобразования страны в массив
	 *
	 * @example
	 * ```php
	 * // Преобразование массива объектов жанров
	 * $genres = [new Genre('драма'), new Genre('триллер')];
	 * $result = $this->getObjectsArray($genres);
	 * // Результат: [['name' => 'драма'], ['name' => 'триллер']]
	 *
	 * // Обработка пустого значения
	 * $result = $this->getObjectsArray(null);
	 * // Результат: []
	 * ```
	 */
	public static function getObjectsArray(mixed $objects): array {
		return $objects ? array_map(fn ($o) => $o->toArray(), $objects) : [];
	}
}